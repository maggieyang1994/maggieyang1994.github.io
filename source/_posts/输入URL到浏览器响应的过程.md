---
title: 输入URL到浏览器响应的过程
date: 2020-06-17
categories: 
- 计算机网络
rank: 3
tags: 
  - TCP/IP
  
---


{% path  HTTP/shakehand.png %}
1. DNS解析， 将域名解析为ip地址
			- 浏览器缓存 ---》 操作系统缓存-----》 路由器缓存------》 isp的dns服务器 -----》根服务器
2. TCP连接（三次握手）

	-  **客户端发送一个带 SYN同步序列号(跟时间戳有关)的数据包到服务器**（第一次握手，由浏览器发起，告诉服务器我要发送请求了, 证明客户端可以发送数据）
	-   **服务器发回一个 SYN， ACK=上一个SYN + 1 的响应包以示传达确认信息**（第二次握手，由服务器发起，告诉浏览器我准备接受了，你赶紧发送吧， 证明服务器可以接受并且发送数据）
	-   **客户端再回传一个带 ACK= 上一个SYN + 1  的数据包，代表“握手结束”**（第三次握手，由浏览器发送，告诉服务器，我马上就发了，准备接受吧, 证明 客户端可以接受数据）

3. 发送http请求
4. 服务器处理请求
5. 浏览器解析页面
		 - 根据HTMl解析 DOM树（深度优先遍历）， 遇到script停止
		 - 根据CSS解析成 CSS规则树(解析css的顺序决定了css的优先级）
		 - 将CSS和DOM树 整合成render 树【将对应的css应用到对应的dom上, 只渲染可见节点】
		 - 对页面进行重排（根据dom尺寸，位置进行布局）
		 - 对页面进行重绘
		
6. 断开连接 （tcp四次挥手）
	-   客户端数据传输完毕之后，发起一个FIN: X的数据包（表示关闭客户端到服务端的数据传送）
	-    服务端接收之后， 回复一个确认包ACK: X + 1（此时理论上客户端已经不能发送数据了， 处于一个 **半关闭**状态）
	-    服务端数据传输完毕之后发送一个FIN： X包（表示服务端主动关闭到客户端的数据传送）
	-   客户端收到服务端的FIN包之后， 回复一个ACK: X + 1 确认包（双方都关闭）